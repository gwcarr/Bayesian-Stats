chains <- as.matrix(sims)
simsall <- as.mcmc(chains)
geweke.diag(sims)
geweke.diag(simsall)
gelman.diag(sims)
raftery.diag(simsall)
plot(chains[,7])
plot(chains[,7], type = 'l')
plot(chains[,9], type = 'l')
plot(chains[,10], type = 'l')
plot(chains[,11], type = 'l')
plot(chains[,12], type = 'l')
plot(csims)
plot(sims)
plot(chains[,12], type = 'l')
plot(chains[,10], type = 'l')
plot(chains[,1], type = 'l')
plot(chains[,10], type = 'l')
plot(chains[,8], type = 'l')
plot(chains[,10], type = 'l')
plot(chains[,2], type = 'l')
plot(chains[,2:10], type = 'l')
plot(chains[,2], type = 'l')
plot(chains[,11], type = 'l')
plot(chains[,13], type = 'l')
plot(chains[,12], type = 'l')
raftery.diag(sims)
raftery.diag(simsall)
autocorr.diag(simsall)
effectiveSize(sims)
mu11 <- chains[,2]
mu12 <- chains[,3]
mu13 <- chains[,4]
mu21 <- chains[,5]
mu22 <- chains[,6]
mu23 <- chains[,7]
mu31 <- chains[,8]
mu32 <- chains[,9]
mu33 <- chains[,10]
vr1 <- chains[,11]
vr2 <- chains[,12]
vr3 <- chains[,13]
mu11 <- chains[,2]
mu12 <- chains[,3]
mu13 <- chains[,4]
mu21 <- chains[,5]
mu22 <- chains[,6]
mu23 <- chains[,7]
mu31 <- chains[,8]
mu32 <- chains[,9]
mu33 <- chains[,10]
vr1 <- chains[,11]
vr2 <- chains[,12]
vr3 <- chains[,13]
mu11 <- chains[,2]
mu12 <- chains[,3]
mu13 <- chains[,4]
mu21 <- chains[,5]
mu22 <- chains[,6]
mu23 <- chains[,7]
mu31 <- chains[,8]
mu32 <- chains[,9]
mu33 <- chains[,10]
vr1 <- chains[,11]
vr2 <- chains[,12]
vr3 <- chains[,13]
cint1 <- mu11-mu12-mu21+mu22
cint2 <- mu12-mu13-mu22+mu23
cint3 <- mu21-mu22-mu31+mu32
cint4 <- mu22-mu23-mu32+mu33
cint1
mu11
mean(mu11)
cint1 <- mean(mu11-mu12-mu21+mu22)
cin1
cint1
int1 <- mu11-mu12-mu21+mu22
int2 <- mu12-mu13-mu22+mu23
int3 <- mu11-mu13-mu21+mu23
int4 <- mu21-mu22-mu31+mu32
int5 <- mu22-mu23-mu32+mu33
int6 <- mu21-mu23-mu31+mu33
plot(density(int1))
mean(int1>0)
plot(density(int2))
mean(int2>0)
plot(density(int3))
mean(int3>0)
plot(density(int1))
plot(density(int1))
plot(density(int1))
plot(density(int2))
plot(density(int3))
plot(density(int4))
plot(density(int5))
plot(density(int6))
mean(int1>0)
mean(int1>0)
mean(int2>0)
mean(int3>0)
mean(int4>0)
mean(int5>0)
mean(int6>0)
plot(density(int4))
plot(density(int7))
int7 <- mu11-mu13-mu31+mu33
plot(density(int7))
mean(int7>0)
mean(int1>0)
mean(int2>0)
mean(int3>0)
mean(int4>0)
mean(int5>0)
mean(int6>0)
mean(int7>0)
mean(chains)
mean(chains[,2])
mean(sims)
mean(sim)
mean(simsall)
int1 <- mu11-mu12-mu21+mu22
int2 <- mu12-mu13-mu22+mu23
int3 <- mu11-mu12-mu31+mu32
int4 <- mu12-mu13-mu32+mu33
int5 <- mu11-mu13-mu31+mu33
int6 <- mu21-mu22-mu31+mu32
int7 <- mu22-mu23-mu32+mu33
int8 <- mu21-mu23-mu31+mu33
int9 <- mu11-mu13-mu31+mu33
plot(density(int1))
plot(density(int2))
plot(density(int3))
plot(density(int4))
plot(density(int5))
plot(density(int6))
plot(density(int7))
plot(density(int8))
plot(density(int9))
mean(int1>0)
mean(int2>0)
mean(int3>0)
mean(int4>0)
mean(int5>0)
mean(int6>0)
mean(int7>0)
mean(int8>0)
mean(int9>0)
int1 <- mu11-mu12-mu21+mu22
int2 <- mu12-mu13-mu22+mu23
int3 <- mu11-mu12-mu31+mu32
int4 <- mu12-mu13-mu32+mu33
int5 <- mu11-mu13-mu21+mu23
int6 <- mu21-mu22-mu31+mu32
int7 <- mu22-mu23-mu32+mu33
int8 <- mu21-mu23-mu31+mu33
int9 <- mu11-mu13-mu31+mu33
plot(density(int1))
plot(density(int2))
plot(density(int3))
plot(density(int4))
plot(density(int5))
plot(density(int6))
plot(density(int7))
plot(density(int8))
plot(density(int9))
mean(int1>0)
mean(int2>0)
mean(int3>0)
mean(int4>0)
mean(int5>0)
mean(int6>0)
mean(int7>0)
mean(int8>0)
mean(int9>0)
int1 <- mu11-mu12-mu21+mu22
int2 <- mu12-mu13-mu22+mu23
int3 <- mu11-mu12-mu31+mu32
int4 <- mu12-mu13-mu32+mu33
int5 <- mu11-mu13-mu21+mu23
int6 <- mu21-mu22-mu31+mu32
int7 <- mu22-mu23-mu32+mu33
int8 <- mu21-mu23-mu31+mu33
int9 <- mu11-mu13-mu31+mu33
plot(density(int1))
plot(density(int2))
plot(density(int3))
plot(density(int4))
plot(density(int5))
plot(density(int6))
plot(density(int7))
plot(density(int8))
plot(density(int9))
mean(int1>0)
mean(int2>0)
mean(int3>0)
mean(int4>0)
mean(int5>0)
mean(int6>0)
mean(int7>0)
mean(int8>0)
mean(int9>0)
plot(chains[,9], type = 'l')
mu3233 <- mu32-mu33
plot(mu3233)
plot(density(mu3233))
mu3332 <- mu33-mu32
plot(density(mu3332))
oxide.sim
mdl <- "
model {
for (i in 1:27) {
oxide[i] ~ dnorm(mu[type[i], location[i]], 1/vr[type[i]])
}
# Priors
for (i in 1:3) {
for (j in 1:3) {
mu[i,j] ~ dnorm(90, 0.01)
}
vr[i] ~ dgamma(7,0.5)
}
}
"
writeLines(mdl, 'oxide.txt')
oxide <- oxidedat$oxide
location <- oxidedat$location
type <- oxidedat$type
rep <- oxidedat$rep
data.jags <- c('oxide', 'location', 'type')
parms <- c('mu', 'vr')
oxide.sim <- jags(data = data.jags, inits = NULL, parameters.to.save = parms,
model.file='oxide.txt', n.chains = 3, n.iter = 11000,
n.burnin = 2000, n.thin = 2)
oxide.sim
mdl <- "
model {
for (i in 1:27) {
oxide[i] ~ dnorm(mu[type[i], location[i]], 1/vr[type[i]])
}
# Priors
for (i in 1:3) {
for (j in 1:3) {
mu[i,j] ~ dnorm(90, 0.01)
}
vr[i] ~ dgamma(7,0.5)
}
}
"
writeLines(mdl, 'oxide.txt')
oxide <- oxidedat$oxide
location <- oxidedat$location
type <- oxidedat$type
rep <- oxidedat$rep
data.jags <- c('oxide', 'location', 'type')
parms <- c('mu', 'vr')
oxide.sim <- jags(data = data.jags, inits = NULL, parameters.to.save = parms,
model.file='oxide.txt', n.chains = 3, n.iter = 11000,
n.burnin = 2000, n.thin = 2)
oxide.sim
sims <- as.mcmc(oxide.sim)
chains <- as.matrix(sims)
simsall <- as.mcmc(chains)
geweke.diag(sims)
geweke.diag(simsall)
gelman.diag(sims)
raftery.diag(sims)
raftery.diag(simsall)
plot(chains[,2], type = 'l')
plot(chains[,8], type = 'l')
plot(chains[,9], type = 'l')
plot(chains[,10], type = 'l')
plot(chains[,11], type = 'l')
plot(chains[,12], type = 'l')
plot(chains[,13], type = 'l')
autocorr.diag(simsall)
effectiveSize(sims)
mu11 <- chains[,2]
mu12 <- chains[,3]
mu13 <- chains[,4]
mu21 <- chains[,5]
mu22 <- chains[,6]
mu23 <- chains[,7]
mu31 <- chains[,8]
mu32 <- chains[,9]
mu33 <- chains[,10]
vr1 <- chains[,11]
vr2 <- chains[,12]
vr3 <- chains[,13]
int1 <- mu11-mu12-mu21+mu22
int2 <- mu12-mu13-mu22+mu23
int3 <- mu11-mu12-mu31+mu32
int4 <- mu12-mu13-mu32+mu33
int5 <- mu11-mu13-mu21+mu23
int6 <- mu21-mu22-mu31+mu32
int7 <- mu22-mu23-mu32+mu33
int8 <- mu21-mu23-mu31+mu33
int9 <- mu11-mu13-mu31+mu33
plot(density(int1))
plot(density(int2))
plot(density(int3))
plot(density(int4))
plot(density(int5))
plot(density(int6))
plot(density(int7))
plot(density(int8))
plot(density(int9))
mean(int1>0)
mean(int2>0)
mean(int3>0)
mean(int4>0)
mean(int5>0)
mean(int6>0)
mean(int7>0)
mean(int8>0)
mean(int9>0)
mu3332 <- mu33-mu32
plot(density(mu3332))
oxide.sim
mdl <- "
model {
for (i in 1:27) {
oxide[i] ~ dnorm(mu[type[i], location[i]], 1/vr[type[i]])
}
# Priors
for (i in 1:3) {
for (j in 1:3) {
mu[i,j] ~ dnorm(90, 0.01)
}
vr[i] ~ dgamma(6,0.5)
}
}
"
writeLines(mdl, 'oxide.txt')
oxide <- oxidedat$oxide
location <- oxidedat$location
type <- oxidedat$type
rep <- oxidedat$rep
data.jags <- c('oxide', 'location', 'type')
parms <- c('mu', 'vr')
oxide.sim <- jags(data = data.jags, inits = NULL, parameters.to.save = parms,
model.file='oxide.txt', n.chains = 3, n.iter = 11000,
n.burnin = 2000, n.thin = 2)
oxide.sim
sims <- as.mcmc(oxide.sim)
chains <- as.matrix(sims)
simsall <- as.mcmc(chains)
geweke.diag(sims)
geweke.diag(simsall)
gelman.diag(sims)
raftery.diag(sims)
raftery.diag(simsall)
plot(chains[,2], type = 'l')
plot(chains[,8], type = 'l')
plot(chains[,9], type = 'l')
plot(chains[,10], type = 'l')
plot(chains[,11], type = 'l')
plot(chains[,12], type = 'l')
plot(chains[,13], type = 'l')
autocorr.diag(simsall)
effectiveSize(sims)
mu11 <- chains[,2]
mu12 <- chains[,3]
mu13 <- chains[,4]
mu21 <- chains[,5]
mu22 <- chains[,6]
mu23 <- chains[,7]
mu31 <- chains[,8]
mu32 <- chains[,9]
mu33 <- chains[,10]
vr1 <- chains[,11]
vr2 <- chains[,12]
vr3 <- chains[,13]
int1 <- mu11-mu12-mu21+mu22
int2 <- mu12-mu13-mu22+mu23
int3 <- mu11-mu12-mu31+mu32
int4 <- mu12-mu13-mu32+mu33
int5 <- mu11-mu13-mu21+mu23
int6 <- mu21-mu22-mu31+mu32
int7 <- mu22-mu23-mu32+mu33
int8 <- mu21-mu23-mu31+mu33
int9 <- mu11-mu13-mu31+mu33
plot(density(int1))
plot(density(int2))
plot(density(int3))
plot(density(int4))
plot(density(int5))
plot(density(int6))
plot(density(int7))
plot(density(int8))
plot(density(int9))
mean(int1>0)
mean(int2>0)
mean(int3>0)
mean(int4>0)
mean(int5>0)
mean(int6>0)
mean(int7>0)
mean(int8>0)
mean(int9>0)
mu3332 <- mu33-mu32
plot(density(mu3332))
oxide.sim
mu3322 <- mu33-mu22
plot(density(mu3322))
oxide.sim
mdl <- "
model {
for (i in 1:27) {
oxide[i] ~ dnorm(mu[type[i], location[i]], 1/vr[type[i]])
}
# Priors
for (i in 1:3) {
for (j in 1:3) {
mu[i,j] ~ dnorm(90, 0.01)
}
vr[i] ~ dgamma(6,0.5)
}
}
"
writeLines(mdl, 'oxide.txt')
oxide <- oxidedat$oxide
location <- oxidedat$location
type <- oxidedat$type
rep <- oxidedat$rep
data.jags <- c('oxide', 'location', 'type')
parms <- c('mu', 'vr')
oxide.sim <- jags(data = data.jags, inits = NULL, parameters.to.save = parms,
model.file='oxide.txt', n.chains = 3, n.iter = 11000,
n.burnin = 2000, n.thin = 2)
oxide.sim
sims <- as.mcmc(oxide.sim)
chains <- as.matrix(sims)
simsall <- as.mcmc(chains)
geweke.diag(sims)
geweke.diag(simsall)
gelman.diag(sims)
raftery.diag(sims)
raftery.diag(simsall)
plot(chains[,2], type = 'l')
plot(chains[,8], type = 'l')
plot(chains[,9], type = 'l')
plot(chains[,10], type = 'l')
plot(chains[,11], type = 'l')
plot(chains[,12], type = 'l')
plot(chains[,13], type = 'l')
autocorr.diag(simsall)
effectiveSize(sims)
mu11 <- chains[,2]
mu12 <- chains[,3]
mu13 <- chains[,4]
mu21 <- chains[,5]
mu22 <- chains[,6]
mu23 <- chains[,7]
mu31 <- chains[,8]
mu32 <- chains[,9]
mu33 <- chains[,10]
vr1 <- chains[,11]
vr2 <- chains[,12]
vr3 <- chains[,13]
int1 <- mu11-mu12-mu21+mu22
int2 <- mu12-mu13-mu22+mu23
int3 <- mu11-mu12-mu31+mu32
int4 <- mu12-mu13-mu32+mu33
int5 <- mu11-mu13-mu21+mu23
int6 <- mu21-mu22-mu31+mu32
int7 <- mu22-mu23-mu32+mu33
int8 <- mu21-mu23-mu31+mu33
int9 <- mu11-mu13-mu31+mu33
plot(density(int1))
plot(density(int2))
plot(density(int3))
plot(density(int4))
plot(density(int5))
plot(density(int6))
plot(density(int7))
plot(density(int8))
plot(density(int9))
mean(int1>0)
mean(int2>0)
mean(int3>0)
mean(int4>0)
mean(int5>0)
mean(int6>0)
mean(int7>0)
mean(int8>0)
mean(int9>0)
oxide.sim
quantile(chains[,6], c(0.1, 0.9))
quantile(chains[,12], c(0.1, 0.9))
sqrt(quantile(chains[,12], c(0.1, 0.9)))
round(sqrt(quantile(chains[,12], c(0.1, 0.9))), 3)
source("~/.active-rstudio-document", echo=TRUE)
source("~/R Projects/Bayesian-Stats/linreg.R", echo=TRUE)
linreg.sim$BUGSoutput
linreg.sim$model
plot(x,y)
source("~/R Projects/Bayesian-Stats/linreg.R", echo=TRUE)
source("~/R Projects/Bayesian-Stats/linreg.R", echo=TRUE)
source("~/R Projects/Bayesian-Stats/linreg.R", echo=TRUE)
abline(57.307, 4.382)
abline(57.307, 4.832)
source("~/R Projects/Bayesian-Stats/linreg.R", echo=TRUE)
mu[1]
y[1]
source("~/R Projects/Bayesian-Stats/linreg.R", echo=TRUE)
sims <- as.mcmc(linreg.sim)
gelman.diag(sims)
chains <- as.matrix(sims)
sims <- as.mcmc(chains)
raftery.diag(sims)
effectiveSize(sims)
autocorr.diag(sims)
geweke.diag(sims)
